@model PageResult<Chua>

<div class="content">
    <div class="title-page">
        Quản lý chùa
    </div>
    <div class="search">
        <div class="title-search">Tìm kiếm chùa</div>
        <form>
            <div class="filter">
                <div class="item-filter">
                    <label class="name-filter" name="tenchua">Tên</label>
                    <input name="tenchua" />
                </div>
            </div>
            <div class="btn-box">
                <button class="button" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                        <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" />
                    </svg>
                </button>
                <div class="button btn-create" ">
                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">
                        <path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z" />
                    </svg>
                </div>
            </div>
        </form>
        <div class="show-view" id="show-create">
            <div class="bg-show"></div>
            <div class="container-view">
                <form class="form-create" method="post" asp-area="" asp-controller="QuanLyChua" asp-action="Create">
                    <div class="title-form">Thêm chùa</div>
                    <input type="hidden" name="ChuaId" id="chuaId" value="">
                    <input type="hidden" name="TruTri" id="truTriId" value="1">
                    <div class="info">
                        <div class="item-info col-3">
                            <label class="name-info">Tên chùa</label>
                            <input type="text" placeholder="Nhập tên chùa" name="TenChua" id="tenchua" value="" required />
                        </div>
                        <div class="item-info col-3">
                            <label class="name-info">Địa chỉ</label>
                            <input type="text" placeholder="Nhập địa chỉ" name="DiaChi" id="diaChi" value="" />
                        </div>
                        <div class="item-info col-3">
                            <label class="name-info">Ngày thành lập</label>
                            <input type="text" name="NgayThanhLap" id="ngayThanhLap" placeholder="Nhập ngày" onfocus="(this.type='date')" onblur="if(this.value==''){this.type='text'}" />
                        </div> 
                    </div>
                    <div class="area-btn">
                        <button type="submit" class="btn-ok">Thêm chùa</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="list-data">
        <div class="show-view" id="show-view">
            <div class="bg-show"></div>
            <div class="container-view">
                <div class="form-view">
                    <div class="title-form">Thông tin chùa</div>
                    <input type="hidden" name="ChuaId" id="ChuaId" value="">
                    <div class="info">
                        <div class="item-info col-3">
                            <label class="name-info">Tên chùa</label>
                            <input type="text" placeholder="Nhập tên chùa" name="TenChua" id="TenChua" value="" disabled />
                        </div>
                        <div class="item-info col-3">
                            <label class="name-info">Địa chỉ</label>
                            <input type="text" placeholder="Nhập địa chỉ" name="DiaChi" id="DiaChi" value="" disabled />
                        </div>
                        <div class="item-info col-3">
                            <label class="name-info">Ngày thành lập</label>
                            <input type="text" name="NgayThanhLap" id="NgayThanhLap" placeholder="Nhập ngày" onfocus="(this.type='date')" onblur="if(this.value==''){this.type='text'}" disabled />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="filter-data">
            <form method="get" asp-controller="QuanLyChua" asp-action="Index">
                <select name="PageSize" id="PageSize" onchange="form.submit()">
                    <option selected>Hiển thị @Model.Data.ToList().Count() trên @Model.Pagination.TotalCount</option>
                    <option value="5">Hiển thị 5</option>

                    <option value="10">Hiển thị 10</option>
                </select>
            </form>
        </div>
        <table>

            <thead>
                <tr style="height: 40px">
                    <th>
                    </th>
                    <th style="width: 40%;">
                        Tên chùa
                    </th>
                    <th style="width: 30%;">
                        Địa chỉ
                    </th>
                    <th style="width: 30%;">
                        Ngày thành lập
                    </th>
                    <th>
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var chua in Model.Data)
                {
                    <tr>
                        <td>
                            <div class="view-info" id="chua-@chua.ChuaId" data-chuaid="@chua.ChuaId" data-tenchua="@chua.TenChua" data-diachi="@chua.DiaChi" 
                                 data-ngaythanhlap="@chua.NgayThanhLap" data-trutriid="@chua.TruTri">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">
                                    <path d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z" />
                                </svg>
                            </div>
                        </td> 
                        <td>@chua.TenChua</td>
                        <td>@chua.DiaChi</td>
                        <td>@{
                                string date = "Null";
                                if(chua.NgayThanhLap.HasValue)
                                {
                                    date = ((DateTime)chua.NgayThanhLap).ToString("dd/MM/yyyy");
                                }            
                            }
                            @date
                        </td>
                        <td>
                            <div class="edit-info" id="edit-info" id="chua-@chua.ChuaId" data-chuaid="@chua.ChuaId" data-tenchua="@chua.TenChua" data-diachi="@chua.DiaChi"
                                 data-ngaythanhlap="@chua.NgayThanhLap" data-trutriid="@chua.TruTri">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                                    <path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z" />
                                </svg>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        @if (Model.Pagination.TotalPage > 1)
        {
            <div class="pagination-ct">
                <ul>
                    <li class="page-item @(Model.Pagination.PageNumber == 1 ? "disabled" : "")">
                        <a class="page-link" href="#" aria-label="Previous" data-page-number="@{
                            var a = Model.Pagination.PageNumber - 1; @a
                        }" data-page-size="@Model.Pagination.PageSize">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    @for (int i = 1; i <= @Model.Pagination.TotalPage; i++)
                    {
                        <li class="page-item @(i == Model.Pagination.PageNumber ? "active" : "")">
                            <a class="page-link" href="#" data-page-number="@i" data-page-size="@Model.Pagination.PageSize" style="cursor: pointer">@i</a>
                        </li>
                    }
                    <li class="page-item @(Model.Pagination.PageNumber == Model.Pagination.TotalPage ? "disabled" : "")">
                        <a class="page-link" href="#" aria-label="Next" data-page-number="@{
                            var next = Model.Pagination.PageNumber + 1; @next
                        }" data-page-size="@Model.Pagination.PageSize">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                </ul>
            </div>
        }
    </div>
    <div class="show-view" id="show-edit">
        <div class="bg-show"></div>
        <div class="container-view">
            <form class="form-create" method="post" asp-area="" asp-controller="QuanLyChua" asp-action="Edit">
                <div class="title-form">Cập nhật chùa</div>
                <input type="hidden" name="ChuaId" id="e-chuaId" value="">
                <div class="info">
                    <div class="item-info col-3">
                        <label class="name-info">Tên Chùa</label>
                        <input type="text" placeholder="Nhập tên chùa" name="TenChua" id="e-tenChua" value="" required />
                    </div>
                    <div class="item-info col-3">
                        <label class="name-info">Địa chỉ</label>
                        <input type="text" placeholder="Nhập địa chỉ" name="DiaChi" id="e-diaChi" value="" />
                    </div>
                    
                    <div class="item-info col-3">
                        <label class="name-info">Ngày thành lập</label>
                        <input type="text" name="NgayThanhLap" id="e-ngayThanhLap" placeholder="Nhập ngày" onfocus="(this.type='date')" onblur="if(this.value==''){this.type='text'}" />
                    </div>
                </div>
                <div class="area-btn">
                    <button type="submit" class="btn-ok">Sửa chùa</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $(".bg-show").click(function () {
            $(".show-view").hide();
            $(".form-create")[0].reset();
            $("body").css("overflow", "unset");
        });
        $(".btn-create").click(function () {
            $("#show-create").show();
            $("body").css("overflow", "hidden");
        });
        $(".view-info").click(function () {
            // Lấy dữ liệu được gán từ view-info
            var chuaid = $(this).data('chuaid');
            var tenchua = $(this).data('tenchua');
            var diachi = $(this).data('diachi');
            var ngaythanhlap = $(this).data('ngaythanhlap');
            var trutriid = $(this).data('trutriid');
            
            // Gán giữ liệu cho value input để show
            $("#ChuaId").val(chuaid);
            $("#TenChua").val(tenchua);
            $("#DiaChi").val(diachi);
            $("#NgayThanhLap").val(ngaythanhlap);
            $("#TruTri").val(trutriid);
            $("body").css("overflow", "hidden");
            $("#show-view").show();
        });

        $(".edit-info").click(function () {
            // Lấy dữ liệu được gán từ view-info
            var chuaid = $(this).data('chuaid');
            var tenchua = $(this).data('tenchua');
            var diachi = $(this).data('diachi');
            var ngaythanhlap = $(this).data('ngaythanhlap');
            var trutriid = $(this).data('trutriid');

            // Gán giữ liệu cho value input để show
            $("#e-chuaId").val(chuaid);
            $("#e-tenChua").val(tenchua);
            $("#e-diaChi").val(diachi);
            $("#e-ngayThanhLap").val(ngaythanhlap);
            $("#e-truTri").val(trutriid);
            $("body").css("overflow", "hidden");
            $("#show-edit").show();
        });

        $(".page-link").click(function () {
            var pageNumber = $(this).data("page-number");
            var pageSize = $(this).data("page-size")

            // Gửi yêu cầu đến server với pageNumber và pageSize đã chọn
            window.location.href = "/QuanLyChua?PageSize=" + pageSize + "&PageNumber=" + pageNumber;
        });
    });
</script>
